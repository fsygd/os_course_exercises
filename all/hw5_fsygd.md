## 思考题

------

## “连续内存分配”与视频相关的课堂练习

### 5.1 计算机体系结构和内存层次

1.操作系统中存储管理的目标是什么？

- 抽象
- 保护
- 共享
- 虚拟化

### 5.2 地址空间和地址生成

1.描述编译、汇编、链接和加载的过程是什么？

- 编译：将预处理后的代码编译成汇编代码，隔离了底层硬件的不同实现，提高了移植性
- 汇编：将汇编代码转化成机器码
- 链接：解决多个模块的引用和库调用，然后进行重定位以便生成可执行文件
- 加载：将可执行目标文件中数据和代码节载入到进程的地址空间

### 5.3 连续内存分配

1.什么是内碎片、外碎片？ 2.最先匹配会越用越慢吗？请说明理由（可来源于猜想或具体的实验）？ 3.最差匹配的外碎片会比最优适配算法少吗？请说明理由（可来源于猜想或具体的实验）？ 4.理解0:最优匹配，1:最差匹配，2:最先匹配，3:buddy systemm算法中分区释放后的合并处理过程？ (optional)

1.内存分配的时候有时会分配超出请求大小的空闲内存块，因为内存分配要取整，超过的部分就是内碎片，外碎片就是两个被分配的内存块中间夹着的空闲内存块

2.会，因为会有一些小容量的低地址外碎片，最先匹配每次都会遍历这些碎片，造成时间上的开销

3.会，因为每次找最大的空闲块来进行分配，剩下的部分也不小，有较大的可能被再次利用

4.最优、最差、最先匹配都是按不同的方法找到地址连续的两块内存空间是否空闲，如果是就合并，把这个块按不同顺序插到链表中，buddy system则是找到唯一可能合并的内存块，检查在不在对应长度的链表里，合并到不能合并为止

### 5.4 碎片整理

1.对换和紧凑都是碎片整理技术，它们的主要区别是什么？为什么在早期的操作系统中采用对换技术？

对换是把某些进程的数据从内存搬到外存中，紧凑是对内存中的进程占用的部分进行整理，把空闲部分集中到一起。因为对换技术实现比较简单。

2.一个处于等待状态的进程被对换到外存（对换等待状态）后，等待事件出现了。操作系统需要如何响应？

把该进程的内容从外存读到内存中，如果内存空间不够，就把其他进程占用的部分调到外存中

### 5.5 伙伴系统

1.伙伴系统的空闲块如何组织？

不同的空闲块大小都有一个链表，每个链表维护大小相等的空闲块的起始地址

2.伙伴系统的内存分配流程？伙伴系统的内存回收流程？

分配:

请求(2^(i-1), 2^i]大小的内存时，首先寻找2^i的块的链表是否为空，为空就找2^(i+1)的链表，直到找到一个最小的，如果没找到就分配失败。如果找到的块>=两倍的请求大小，就把当前块分成两个大小相等的块，直到满足要求

回收：

找到内存块在系统中唯一对应的伙伴，检查伙伴的所有页是否都空闲，如果是就合并，直到不能合并为止