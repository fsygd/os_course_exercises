## 与视频相关思考题

### 6.1	非连续内存分配的需求背景

1. 为什么要设计非连续内存分配机制？

   因为很多时候无法分配连续的内存，非连续分配对内存的利用率更高

2. 非连续内存分配中内存分块大小有哪些可能的选择？大小与大小是否可变?

   可以有大块的也可以是小块的，段式大小可变，页式大小固定

3. 为什么在大块时要设计大小可变，而在小块时要设计成固定大小？小块时的固定大小可以提供多种选择吗？

   大小可变的块更加灵活，固定大小方便进行管理，小块数量多，如果大小可变开销大，大块很难定一个固定的值，小了不满足要求，大了利用率低。小块时的固定大小不同机器可能不同，但不能灵活改变

### 6.2	段式存储管理

1. 什么是段、段基址和段内偏移？

   段表示访问方式、权限相同的一段地址空间，段基址是这个段的起始地址，段内偏移是段中某个地址相对基址的偏移量

2. 段式存储管理机制的地址转换流程是什么？为什么在段式存储管理中，各段的存储位置可以不连续？这种做法有什么好处和麻烦？

   转换流程：以段选择子的高位为索引，从段表中找到对应的表项，段基址加上段偏移量就完成了转换

   段是按程序的逻辑结构来划分的，不考虑共享的话一般程序不会去访问其他程序的段，所以可以不连续

   好处是不连续可以提高内存利用率，方便进行权限的管理和检查，麻烦是需要进行地址转换

### 6.3	页式存储管理

1. 什么是页（page）、帧（frame）、页表（page table）、存储管理单元（MMU）、快表（TLB, Translation Lookaside Buffer）和高速缓存（cache）？

   帧（frame）是物理页面，页（page）是逻辑页面，页表（page table）用来存储逻辑页面页号与物理页面页号的转换关系，存储管理单元（MMU）来对地址进行转换，快表是对页表的缓存，高速缓存是对内存的缓存，利用空间局部性和高速缓存的速度优势来加快访存

2. 页式存储管理机制的地址转换流程是什么？为什么在页式存储管理中，各页的存储位置可以不连续？这种做法有什么好处和麻烦？

   流程是页号+页内偏移

   因为每个逻辑地址经过转换都能找到对应的物理页面，通过页内偏移找到对应的内容，所以可以不连续

   好处是提高了内存的利用率，麻烦是地址转换需要先查页表，再访存，相当于要两次访存，增加了时间的开销，可以利用TLB来加速

### 6.4	页表概述

1. 页表大小受哪些因素影响？

   页大小，进程数，地址空间大小

### 6.5	快表和多级页表

1. 快表（TLB）与高速缓存（cache）有什么不同？

   快表是对页表做了缓存，加快页表的查询速度，高速缓存是对内存的缓存，加快访存的速度

2. 为什么快表中查找物理地址的速度非常快？它是如何实现的？为什么它的的容量很小？

   快表采用SRAM，访问速度比内存要快，用硬件实现，对程序员透明，因为功耗比较大

3. 什么是多级页表？多级页表中的地址转换流程是什么？多级页表有什么好处和麻烦？

   多级页表就是具有层次结构的页表

   先利用页目录基址和索引找到下一级页表的基址，一级一级往下找，直到找到页号，加上偏移地址就是物理地址

   好处是可以减少页表占用的空间，缺点是多级页表需要多次访存，增加了时间的开销

### 6.6	反置页表

1. 页寄存器机制的地址转换流程是什么？

   对逻辑地址进行 Hash映射，在快表中查找对应页表项，有冲突时遍历冲突项链表，找到物理页号以后查看对应页寄存器中的进程和逻辑地址信息是否符合

2. 反置页表机制的地址转换流程是什么？

   逻辑页号和进程号一起做Hash映射，在快表中查找对应页表项，有冲突时遍历冲突项链表，找到物理页号后进行比对

3. 反置页表项有些什么内容？

   进程号，页号和标志位

### 6.7	段页式存储管理

1. 段页式存储管理机制的地址转换流程是什么？这种做法有什么好处和麻烦？

   现在段表中找到相应的项，得到页表地址，再在页表上找到对应的帧号，好处是方便进行权限控制，共享，虚拟化，缺点是多次访问内存会有时间上的开销

2. 如何实现基于段式存储管理的内存共享？

   把共享部分放在一个段内，把虚拟地址的段选择子都指向这个段就能实现内容共享

3. 如何实现基于页式存储管理的内存共享？

   把共享部分放在一个页内，不同页号的虚页和同一个帧号的物理页面进行映射，就能实现内容共享